{% extends "app.html" %} {% load static %} {% block title %}Payment
Selection{%endblock %} {% block content %}

<div class="container">
  <div class="col-12">
    <h1 class="h2">Delivery Options</h1>
  </div>
  <div class="col-12">
    <p>Please select your delivery option</p>
  </div>
  <hr />
</div>

<div class="container">
  <div class="row g-3">
    <div class="col-md-4 col-lg-4 order-md-last p-0 order-3">
      <div class="d-flex bd-highlight ms-0">
        <div class="p-2 flex-grow-1 bd-highlight">Sub Total:</div>
        <div class="p-2 bd-highlight">
          <span class="fw-bold h5">£</span
          ><span id="sub_total" class="fw-bold h5"
            >{{cart.get_subtotal_price}}</span
          >
        </div>
      </div>
      <div class="d-flex bd-highlight">
        <div class="p-2 flex-grow-1 bd-highlight">Delivery Cost:</div>
        <div class="p-2 bd-highlight">
          <span class="fw-bold h5">£</span
          ><span id="delivery_price" class="fw-bold h5"
            >{{cart.get_delivery_price}}</span
          >
        </div>
      </div>
      <div class="d-flex bd-highlight">
        <div class="p-2 flex-grow-1 bd-highlight">Total:</div>
        <div class="p-2 bd-highlight">
          <span class="fw-bold h5">£</span
          ><span id="total" class="fw-bold h5">{{cart.get_total_price}}</span>
        </div>
      </div>
    </div>
    <div class="col-md-7 col-lg-8 pe-0 pe-md-5">
      <div id="payment-form" class="col-12 col-lg-6 mx-auto">
        <h3 class="mb-3">Billing address</h3>
        <!-- Error messages in this element -->
        <div id="card-errors" class="a" role="alert"></div>
        <form>
          <div class="row g-3">
            <div class="col-sm-7">
              <label for="firstName" class="form-label">Customer Name</label>
              <input
                type="text"
                class="form-control"
                id="customerName"
                placeholder=""
                required
              />
              <div class="invalid-feedback">Valid first name is required.</div>
            </div>
            <div class="col-12">
              <label for="email" class="form-label"
                >Email <span class="text-muted">(Optional)</span></label
              >
              <input
                type="email"
                class="form-control"
                id="email"
                placeholder="you@example.com"
              />
              <div class="invalid-feedback">
                Please enter a valid email address for shipping updates.
              </div>
            </div>
            <div class="col-12">
              <label for="phone" class="form-label">Phone</label>
              <input
                type="text"
                class="form-control"
                id="customerPhone"
                placeholder="xxx xxx xx xx"
                required
              />
              <div class="invalid-feedback">
                Please enter your phone number.
              </div>
            </div>
            <div class="col-12">
              <label for="address" class="form-label">Address</label>
              <input
                type="text"
                class="form-control"
                id="customerAddress"
                placeholder="1234 Main St"
                required
              />
              <div class="invalid-feedback">
                Please enter your shipping address.
              </div>
            </div>
            <div class="col-12">
              <label for="address2" class="form-label"
                >Address 2 <span class="text-muted">(Optional)</span></label
              >
              <input
                type="text"
                class="form-control"
                id="customerAddress2"
                placeholder="Apartment or suite"
              />
            </div>
            <div class="col-md-4">
              <label for="city" class="form-label">City</label>
              <select class="form-select" id="city" required>
                <option value="">Choose...</option>
                {% for city in cities %}
                <option value="{{city.name}}">{{city.name}}</option>
                {% endfor %}
              </select>
              <div class="invalid-feedback">Please provide a valid state.</div>
            </div>
            <div class="col-md-3">
              <label for="Postcode" class="form-label">Postcode</label>
              <input
                type="text"
                class="form-control"
                id="postCode"
                placeholder=""
                required
              />
              <div class="invalid-feedback">Zip code required.</div>
            </div>
          </div>
          <hr class="my-4" />
          <h4 class="mb-3">Payment</h4>
          {% if request.GET.payment_type == "paypal" %}
          <h1>Paypal</h1>
          {% else %}
          <label for="card-element">Credit or debit card</label>
          <div id="card-element" class="form-control form-control-payment">
            <!-- Payment elements will appear here -->
          </div>
          <hr class="my-4" />
          <button
            id="submit"
            class="btn btn-primary w-100 fw-bold"
            data-secret="{{ paymentData.client_secret }}"
          >
            Pay
          </button>
          {% endif %}
        </form>
      </div>
    </div>
  </div>
</div>

{% endblock %} {% block scripts %} {% if request.GET.payment_type == "paypal" %}
<script>
  console.log("paypal");
</script>
{% else %}
<script>
  var STRIPE_PUBLISHABLE_KEY =
    "{{paymentInstance.publishable_key}}";
  var CSRF_TOKEN = "{{ csrf_token }}";
</script>
<script src="https://js.stripe.com/v3/"></script>
<script src="{% static 'js/payment.js' %}" data-rel-js></script>
{% endif %} {% endblock %}
